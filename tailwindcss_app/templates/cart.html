{% extends 'base.html'%}
{% load static %}
{% block content %}

<section class="bg-gray-50 font-sans">

  <!-- Header -->
  <section class="relative h-[60vh] flex items-center justify-center bg-cover bg-center" 
           style="background-image: url('https://images.unsplash.com/photo-1552566626-52f8b828add9?auto=format&fit=crop&w=1350&q=80');">
    <div class="absolute inset-0 bg-black bg-opacity-50"></div>
    <h1 class="relative text-5xl md:text-6xl font-bold text-white text-center">
      Votre Panier
    </h1>
  </section>

  <section class="max-w-4xl mx-auto p-8 mt-10 bg-gray-50 rounded-lg shadow-lg border-b border-gray-500">

    <h2 class="text-3xl font-bold mb-6 text-gray-800">Votre Panier</h2>

    {% if items %}

    <div class="overflow-x-auto">
      <table class="min-w-full bg-white shadow-md rounded-lg overflow-hidden">
        <thead class="bg-gray-200 text-gray-700 uppercase text-sm">
          <tr>
            <th class="py-3 px-6 text-left">Image</th>
            <th class="py-3 px-6 text-left">Plat</th>
            <th class="py-3 px-6 text-center">Quantité</th>
            <th class="py-3 px-6 text-center">Prix unitaire (€)</th>
            <th class="py-3 px-6 text-center">Total (€)</th>
            <th class="py-3 px-6 text-center">Action</th>
          </tr>
        </thead>

        <tbody class="text-gray-600 text-sm">

          {% for item in items %}
          <tr class="border-b hover:bg-gray-50">

            <!-- IMAGE DU PLAT -->
            <td class="py-4 px-6">
              <img src="{{ item.dish.image.url }}" 
                   alt="{{ item.dish.name }}" 
                   class="w-16 h-16 object-cover rounded">
            </td>

            <!-- NOM DU PLAT -->
            <td class="py-4 px-6 font-semibold">{{ item.dish.name }}</td>

            <!-- QUANTITÉ -->
            <td class="py-4 px-6 text-center">
              {{ item.quantity }}
            </td>

            <!-- PRIX UNITAIRE -->
            <td class="py-4 px-6 text-center">
              {{ item.dish.price|floatformat:2 }}
            </td>

            <!-- SOUS-TOTAL -->
            <td class="py-4 px-6 text-center">
              {{ item.item_total|floatformat:2 }}
            </td>

            <!-- SUPPRESSION -->
            <td class="py-4 px-6 text-center">
              <a href="{% url 'remove_from_cart' item.dish.id %}" 
                 class="text-red-600 hover:text-red-800 font-semibold">
                Supprimer
              </a>
            </td>

          </tr>
          {% endfor %}

        </tbody>
      </table>
    </div>

    <!-- TOTAL & BOUTONS -->
    <div class="mt-6 text-right">
      <p class="text-xl font-bold text-gray-800">
        Total général : {{ total|floatformat:2 }} €
      </p>

      <a href="{% url 'menu' %}" 
         class="inline-block mt-4 px-6 py-2 bg-blue-600 text-white font-semibold rounded hover:bg-blue-700 transition">
        Continuer la commande
      </a>

      <a href="{% url 'checkout' %}" 
         class="inline-block mt-4 px-6 py-2 bg-green-600 text-white font-semibold rounded hover:bg-green-700 transition">
        Passer à la commande
      </a>
    </div>

    {% else %}

    <!-- PANIER VIDE -->
    <div class="bg-white p-6 rounded shadow-md">
      <p class="text-gray-700 text-lg">Votre panier est vide.</p>

      <a href="{% url 'menu' %}" 
         class="inline-block mt-4 px-6 py-2 bg-blue-600 text-white font-semibold rounded hover:bg-blue-700 transition">
        Retour au menu
      </a>
    </div>

    {% endif %}

  </section>

</section>

{% endblock content %}